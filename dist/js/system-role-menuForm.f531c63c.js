(window.webpackJsonp=window.webpackJsonp||[]).push([["system-role-menuForm"],{4809:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),o=Object(r.createTextVNode)("展开/折叠"),a=Object(r.createTextVNode)("全选/全不选"),c=Object(r.createTextVNode)("取 消"),i=Object(r.createTextVNode)("保 存");var l=n("1da1"),u=(n("d3b7"),n("159b"),n("96cf"),{data:function(){return{visible:!1,isSaveing:!1,loading:!1,form:{id:null,name:null,code:null,menu_ids:null},defaultProps:{children:"children",label:"label"},menuList:[]}},methods:{open:function(){return this.visible=!0,this.loading=!0,this},submit:function(){var e=this;this.$refs.dialogForm.validate(function(){var t=Object(l.a)(regeneratorRuntime.mark((function t(n){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=10;break}return e.isSaveing=!0,e.form.menu_ids=e.getTreeSelectNodes(),t.next=5,e.$API.role.update(e.form.id,e.form);case 5:r=t.sent,e.isSaveing=!1,r.success?(e.visible=!1,e.$message.success(r.message)):e.$alert(r.message,"提示",{type:"error"}),t.next=11;break;case 10:return t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getTreeSelectNodes:function(){var e=this.$refs.tree.getCheckedKeys(),t=this.$refs.tree.getHalfCheckedKeys();return e.unshift.apply(e,t),e},handleTreeExpand:function(e){var t=this;this.menuList.forEach((function(n){t.$refs.tree.store.nodesMap[n.id].expanded=e}))},handleTreeAll:function(e){this.$refs.tree.setCheckedNodes(e?this.menuList:[])},setData:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.form.id=e.id,t.form.name=e.name,t.form.code=e.code,n.next=5,t.$API.menu.tree(e.id).then((function(e){t.menuList=e.data}));case 5:return n.next=7,t.$API.role.getMenuByRole(e.id).then((function(e){e.data[0]&&e.data[0].menus&&e.data[0].menus.forEach((function(e){t.$refs.tree.setChecked(e.id,!0,!1)}))}));case 7:t.loading=!1;case 8:case"end":return n.stop()}}),n)})))()}}}),d=n("6b0d");const s=n.n(d)()(u,[["render",function(e,t,n,l,u,d){var s=Object(r.resolveComponent)("el-input"),f=Object(r.resolveComponent)("el-form-item"),m=Object(r.resolveComponent)("el-checkbox"),b=Object(r.resolveComponent)("el-tree"),p=Object(r.resolveComponent)("el-form"),h=Object(r.resolveComponent)("el-button"),j=Object(r.resolveComponent)("el-dialog"),O=Object(r.resolveDirective)("loading");return Object(r.openBlock)(),Object(r.createBlock)(j,{title:"菜单权限",modelValue:u.visible,"onUpdate:modelValue":t[6]||(t[6]=function(e){return u.visible=e}),width:500,"destroy-on-close":""},{footer:Object(r.withCtx)((function(){return[Object(r.createVNode)(h,{onClick:t[4]||(t[4]=function(e){return u.visible=!1})},{default:Object(r.withCtx)((function(){return[c]})),_:1}),Object(r.createVNode)(h,{type:"primary",loading:u.isSaveing,onClick:t[5]||(t[5]=function(e){return d.submit()})},{default:Object(r.withCtx)((function(){return[i]})),_:1},8,["loading"])]})),default:Object(r.withCtx)((function(){return[Object(r.createVNode)(p,{model:u.form,ref:"dialogForm","label-width":"80px"},{default:Object(r.withCtx)((function(){return[Object(r.createVNode)(f,{label:"角色名称",prop:"name"},{default:Object(r.withCtx)((function(){return[Object(r.createVNode)(s,{modelValue:u.form.name,"onUpdate:modelValue":t[0]||(t[0]=function(e){return u.form.name=e}),size:"small",disabled:!0,clearable:"",placeholder:"请输入角色名称"},null,8,["modelValue"])]})),_:1}),Object(r.createVNode)(f,{label:"代码",prop:"code"},{default:Object(r.withCtx)((function(){return[Object(r.createVNode)(s,{modelValue:u.form.code,"onUpdate:modelValue":t[1]||(t[1]=function(e){return u.form.code=e}),size:"small",disabled:!0,clearable:"",placeholder:"请输入角色代码"},null,8,["modelValue"])]})),_:1}),Object(r.withDirectives)(Object(r.createVNode)(f,{label:"角色权限",prop:"menu_ids","element-loading-background":"rgba(255, 255, 255, 0.8)","element-loading-text":"数据加载中..."},{default:Object(r.withCtx)((function(){return[Object(r.createVNode)(m,{onChange:t[2]||(t[2]=function(e){return d.handleTreeExpand(e)})},{default:Object(r.withCtx)((function(){return[o]})),_:1}),Object(r.createVNode)(m,{onChange:t[3]||(t[3]=function(e){return d.handleTreeAll(e)})},{default:Object(r.withCtx)((function(){return[a]})),_:1}),Object(r.createVNode)(b,{class:"ma-tree-border",ref:"tree",data:u.menuList,"show-checkbox":"","node-key":"id","empty-text":"加载数据中...",props:u.defaultProps},null,8,["data","props"])]})),_:1},512),[[O,u.loading]])]})),_:1},8,["model"])]})),_:1},8,["modelValue"])}]]);t.default=s}}]);